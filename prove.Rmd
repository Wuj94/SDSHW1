---
title: "prove"
author: "Calabrese, Cernigliaro"
date: "20/10/2018"
output:
  html_document: default
  pdf_document: default
linkcolor: cyan
header-includes:
- \usepackage{bbold}
- \usepackage{framed, color}
- \usepackage{graphicx}
- \usepackage{mathabx}
- \definecolor{shadecolor}{rgb}{0.89,0.8,1}
urlcolor: magenta
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


2. As we did in class talking about verifying polynomial identities, to improve on the error probability bound, we can again use the fact that the algorithm has a \emph{one--sided error} and run the algorithm multiple times, say $p$, to get a \emph{$p$-step randomize algorithm}.

a. If we attempt the verification $p = 100$ times (independent from each other), how can we bound the probability of error then?

Since the sampling of the vector $\bar{\boldsymbol{z}}$ happens with replacement, the algorithm is repeated p times independent from each other.
We know that the probability of error for $p = 1$ is:

\[
\Pr(\text{error}) \leq \frac{1}{2}
\]

Since each of the one-step algorithm runs are independent, the probability of error of the p-step algorithm is:

\[
\Pr(\text{p-step error}) = \prod_{i=1}^p \Pr (error) \leq \frac{1}{2^p}
\]

It follows that for p = 100, we have:

\[
\Pr(\text{100-step error}) \leq \frac{1}{2^{100}}
\]

2.b As we noticed in class, an interesting related problem is to evaluate the gradual change in our confidence in the correctness of the matrix multiplication as we repeat the randomized test. Let $E$ be the event that the matrix identity is correct, and let $B$ be the event that the test returns that the identity is correct. How likely is $E$ in light of $B$ and how sensible is this result to your initial, ``personal'' probabilistic assumptions?

Let's clarify the problem, starting from the events: 

\[
E = \{UV = W\}
\]
\[
B = \{\text{the test returns the identity UV = W}\}
\]

Since we don't know the initial value of $\Pr(E)$, we assign $1/2$ to it (as a starting point we trivially assume that half of the times we get $UV = W$).
Using Bayes' theorem:

\[
\Pr(E|B) = \frac{\Pr(B|E)\Pr(E)}{\Pr(B)} = \frac{\Pr(B|E)\Pr(E)}{\Pr(B|E)\Pr(E)+ \Pr(B|E^C)\Pr(E^C)}
\]

We immediately notice that $\Pr(E^c) = 1/2$.
The probability of getting a positive test given that the matrices are equal is $1$, due to the fact that for each vector $\bar{\boldsymbol{z}}$, if we know that $UV = W$, we get the identity verified. So $\Pr(B|E) = 1$. Moreover, we know that $\Pr(B|E^C)$ is the probability of the one-side error, that we have obtained in the point 2.b as $1/2^p$.
Using Bayes' theorem, we conclude:

\[
\Pr(E|B) \leq \frac{1 \cdot \frac{1}{2}}{1 \cdot \frac{1}{2} + \frac{1}{2^p}\cdot\frac{1}{2}} = \frac{1}{1+\frac{1}{2^p}}
\]

c. Assume now that running the $p$-step randomize algorithm, it \underline{always} returns that the identity is correct. As $p$ varies from $1$ to $50$, how does the probability of $E$ change based on this increasingly overwhelming empirical evidence?


In this case, we don't know the prior probability of E. But we can use the Iterative Bayes approach, and from a $\Pr(E)$ chosen arbitrarily, we can update this probability for each step, in light of the happening of the event B for each iteration.

```{r}
# iterative bayes for p from 1 to 50
p <- 50
p.error <- .5 # less than .5

results <- vector(mode="numeric", length = p)
results[1] <- .5 # personal probabilistic assumption

for(i in 1:p){
  p.e.given.b <- (results[i]) / (results[i] + p.error*(1 - results[i]))
  if( i != p )
    results[i + 1] <- p.e.given.b
}


# 2.d ---------------------------------------------------------------------

#library(manipulate)
#manipulate(plot(results, xlim=c(0,x.max)),  x.max=slider(1,p))
#manipulate(plot(1:x), x = slider(1, 100))
```

## Exercise 02: Version B

Monty Hall's problem modified.

$H_i = \{\text{Door i has the prize behind}\} \longrightarrow \Pr(H_i) = \frac{1}{3}$ $\forall i \in \{1,2,3\}$

$B = \{\text{the earthquake opens door 3}\}$

Find $\Pr(H_1|B)$, knowing that the player choose door 1.

Using Bayes' theorem:

\[
\Pr(H_1|B) = \frac{\Pr(B|H_1) \Pr(H_1)}{\Pr(B|H_1)P(H_1) + \Pr(B|H_2)P(H_2) + \Pr(B|H_3)P(H_3)}
\]

We can think about the $\Pr(B|H_i)$.

$\Pr(B|H_3)$ is $0$, due to the fact that it's impossible that the door contains the price, because we're assuming that the earthquake opens the door three and it shows that there's no prize behind it.

$\Pr(B|H_2)$ and $\Pr(B|H_1)$ are the remaining doors which could contain the prize. Since there's a new sample space after the earthquake, and we know that it could be only in those 2 doors, the probabilities are both $1/2$.

In the end we obtain:

\[
\Pr(H_1|B) = \frac{1/2 \cdot 1/3}{1/2 \cdot 1/3 + 1/2 \cdot 1/3 } = \frac{1}{2}
\]


